<!DOCTYPE html>
<head>
    <svg width="960" height="400"></svg>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>
    <svg width="960" height="130"></svg>
    <style>
        .hidden {
            display: none;
        }
        div.tooltip {
            color: #222;
            background-color: #fff;
            padding: .5em;
            text-shadow: #f5f5f5 0 1px 0;
            border-radius: 2px;
            opacity: 0.9;
            position: absolute;
        }

    </style>
</head>
<body>
<script>
    // Set the dimensions of the canvas / graph

    console.log(d3);

    Promise.all([
        d3.json('geojson/states-better.json')
    ]).then( ([states]) => {
        createMap(states);
    })

    function getRange(d) {
        var wage = d.properties.Wage;
        if(wage > 12.5 ){
            return "#fc8d59"
        }
        if(wage > 10 && wage < 12.49){
            return "#d7191c"
        }
        if(wage > 7.25 && wage < 9.99){
            return "#2b83ba"
        }
        else{
            return "#abdda4";
        }
    }

    function createMap(states){

        console.log(states);

        var proj = d3.geoAlbersUsa()
            .translate([250, 250])
            .scale(500);

        var geoPath = d3.geoPath()
            .projection(proj)

        // draw states boundary
        d3.select('svg')
            .selectAll('path')
            .data(states.features)
            .enter()
            .append('path')
            .attr('d', function(d){ return geoPath(d)})
            .attr("text-anchor","middle")
            .attr('stroke-width', 1)
            .attr('stroke', '#252525')
            .attr('fill', function(d){
                return getRange(d);
            })
            .attr("opacity", "70%")
            .on("mouseover", function(e, data){
                d3.select(this).attr("stroke-width", 2).attr("opacity", "100%")

            })
            .on("mouseout", function(d){
                d3.select(this).attr("fill", function(d){
                    return getRange(d);
                }).attr("stroke-width", 1).attr("opacity", "70%");
            })

    }


</script>
</body>